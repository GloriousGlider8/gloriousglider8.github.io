// Generated automatically with "fut". Do not edit.

/**
 * Taken From https://github.com/ariankordi/mii-fusion-experiments
 * CharInfo for CFL/FFL, representing fields of Ver3StoreData.
 */
export class Ver3CharInfo
{
	#miiVersion;
	#faceType;
	#faceColor;
	#faceTex;
	#faceMake;
	#hairType;
	#hairColor;
	#hairFlip;
	#eyeType;
	#eyeColor;
	#eyeScale;
	#eyeAspect;
	#eyeRotate;
	#eyeX;
	#eyeY;
	#eyebrowType;
	#eyebrowColor;
	#eyebrowScale;
	#eyebrowAspect;
	#eyebrowRotate;
	#eyebrowX;
	#eyebrowY;
	#noseType;
	#noseScale;
	#noseY;
	#mouthType;
	#mouthColor;
	#mouthScale;
	#mouthAspect;
	#mouthY;
	#mustacheType;
	#beardType;
	#beardColor;
	#beardScale;
	#beardY;
	#glassType;
	#glassColor;
	#glassScale;
	#glassY;
	#moleType;
	#moleScale;
	#moleX;
	#moleY;
	#height;
	#build;
	#name = new Uint16Array(11);
	#creatorName = new Uint16Array(11);
	#gender;
	#birthMonth;
	#birthDay;
	#favoriteColor;
	#favorite;
	#copyable;
	#ngWord;
	#localonly;
	#regionMove;
	#fontRegion;
	#roomIndex;
	#positionInRoom;
	#birthPlatform;
	#createId = new Uint8Array(10);
	#authorType;
	#authorId = new Uint8Array(8);

	getMiiVersion()
	{
		return this.#miiVersion;
	}

	setMiiVersion(value)
	{
		this.#miiVersion = value;
	}

	getFaceType()
	{
		return this.#faceType;
	}

	setFaceType(value)
	{
		this.#faceType = value;
	}

	getFaceColor()
	{
		return this.#faceColor;
	}

	setFaceColor(value)
	{
		this.#faceColor = value;
	}

	getFaceTex()
	{
		return this.#faceTex;
	}

	setFaceTex(value)
	{
		this.#faceTex = value;
	}

	getFaceMake()
	{
		return this.#faceMake;
	}

	setFaceMake(value)
	{
		this.#faceMake = value;
	}

	getHairType()
	{
		return this.#hairType;
	}

	setHairType(value)
	{
		this.#hairType = value;
	}

	getHairColor()
	{
		return this.#hairColor;
	}

	setHairColor(value)
	{
		this.#hairColor = value;
	}

	getHairFlip()
	{
		return this.#hairFlip;
	}

	setHairFlip(value)
	{
		this.#hairFlip = value;
	}

	getEyeType()
	{
		return this.#eyeType;
	}

	setEyeType(value)
	{
		this.#eyeType = value;
	}

	getEyeColor()
	{
		return this.#eyeColor;
	}

	setEyeColor(value)
	{
		this.#eyeColor = value;
	}

	getEyeScale()
	{
		return this.#eyeScale;
	}

	setEyeScale(value)
	{
		this.#eyeScale = value;
	}

	getEyeAspect()
	{
		return this.#eyeAspect;
	}

	setEyeAspect(value)
	{
		this.#eyeAspect = value;
	}

	getEyeRotate()
	{
		return this.#eyeRotate;
	}

	setEyeRotate(value)
	{
		this.#eyeRotate = value;
	}

	getEyeX()
	{
		return this.#eyeX;
	}

	setEyeX(value)
	{
		this.#eyeX = value;
	}

	getEyeY()
	{
		return this.#eyeY;
	}

	setEyeY(value)
	{
		this.#eyeY = value;
	}

	getEyebrowType()
	{
		return this.#eyebrowType;
	}

	setEyebrowType(value)
	{
		this.#eyebrowType = value;
	}

	getEyebrowColor()
	{
		return this.#eyebrowColor;
	}

	setEyebrowColor(value)
	{
		this.#eyebrowColor = value;
	}

	getEyebrowScale()
	{
		return this.#eyebrowScale;
	}

	setEyebrowScale(value)
	{
		this.#eyebrowScale = value;
	}

	getEyebrowAspect()
	{
		return this.#eyebrowAspect;
	}

	setEyebrowAspect(value)
	{
		this.#eyebrowAspect = value;
	}

	getEyebrowRotate()
	{
		return this.#eyebrowRotate;
	}

	setEyebrowRotate(value)
	{
		this.#eyebrowRotate = value;
	}

	getEyebrowX()
	{
		return this.#eyebrowX;
	}

	setEyebrowX(value)
	{
		this.#eyebrowX = value;
	}

	getEyebrowY()
	{
		return this.#eyebrowY;
	}

	setEyebrowY(value)
	{
		this.#eyebrowY = value;
	}

	getNoseType()
	{
		return this.#noseType;
	}

	setNoseType(value)
	{
		this.#noseType = value;
	}

	getNoseScale()
	{
		return this.#noseScale;
	}

	setNoseScale(value)
	{
		this.#noseScale = value;
	}

	getNoseY()
	{
		return this.#noseY;
	}

	setNoseY(value)
	{
		this.#noseY = value;
	}

	getMouthType()
	{
		return this.#mouthType;
	}

	setMouthType(value)
	{
		this.#mouthType = value;
	}

	getMouthColor()
	{
		return this.#mouthColor;
	}

	setMouthColor(value)
	{
		this.#mouthColor = value;
	}

	getMouthScale()
	{
		return this.#mouthScale;
	}

	setMouthScale(value)
	{
		this.#mouthScale = value;
	}

	getMouthAspect()
	{
		return this.#mouthAspect;
	}

	setMouthAspect(value)
	{
		this.#mouthAspect = value;
	}

	getMouthY()
	{
		return this.#mouthY;
	}

	setMouthY(value)
	{
		this.#mouthY = value;
	}

	getMustacheType()
	{
		return this.#mustacheType;
	}

	setMustacheType(value)
	{
		this.#mustacheType = value;
	}

	getBeardType()
	{
		return this.#beardType;
	}

	setBeardType(value)
	{
		this.#beardType = value;
	}

	getBeardColor()
	{
		return this.#beardColor;
	}

	setBeardColor(value)
	{
		this.#beardColor = value;
	}

	getBeardScale()
	{
		return this.#beardScale;
	}

	setBeardScale(value)
	{
		this.#beardScale = value;
	}

	getBeardY()
	{
		return this.#beardY;
	}

	setBeardY(value)
	{
		this.#beardY = value;
	}

	getGlassType()
	{
		return this.#glassType;
	}

	setGlassType(value)
	{
		this.#glassType = value;
	}

	getGlassColor()
	{
		return this.#glassColor;
	}

	setGlassColor(value)
	{
		this.#glassColor = value;
	}

	getGlassScale()
	{
		return this.#glassScale;
	}

	setGlassScale(value)
	{
		this.#glassScale = value;
	}

	getGlassY()
	{
		return this.#glassY;
	}

	setGlassY(value)
	{
		this.#glassY = value;
	}

	getMoleType()
	{
		return this.#moleType;
	}

	setMoleType(value)
	{
		this.#moleType = value;
	}

	getMoleScale()
	{
		return this.#moleScale;
	}

	setMoleScale(value)
	{
		this.#moleScale = value;
	}

	getMoleX()
	{
		return this.#moleX;
	}

	setMoleX(value)
	{
		this.#moleX = value;
	}

	getMoleY()
	{
		return this.#moleY;
	}

	setMoleY(value)
	{
		this.#moleY = value;
	}

	getHeight()
	{
		return this.#height;
	}

	setHeight(value)
	{
		this.#height = value;
	}

	getBuild()
	{
		return this.#build;
	}

	setBuild(value)
	{
		this.#build = value;
	}

	getName()
	{
		return this.#name;
	}

	setName(value, offset = 0)
	{
		for (let i = 0; i < 10; i++)
			this.#name[i] = value[offset + i];
		this.#name[10] = 0;
	}

	getCreatorName()
	{
		return this.#creatorName;
	}

	setCreatorName(value, offset = 0)
	{
		for (let i = 0; i < 10; i++)
			this.#creatorName[i] = value[offset + i];
		this.#creatorName[10] = 0;
	}

	getGender()
	{
		return this.#gender;
	}

	setGender(value)
	{
		this.#gender = value;
	}

	getBirthMonth()
	{
		return this.#birthMonth;
	}

	setBirthMonth(value)
	{
		this.#birthMonth = value;
	}

	getBirthDay()
	{
		return this.#birthDay;
	}

	setBirthDay(value)
	{
		this.#birthDay = value;
	}

	getFavoriteColor()
	{
		return this.#favoriteColor;
	}

	setFavoriteColor(value)
	{
		this.#favoriteColor = value;
	}

	getFavorite()
	{
		return this.#favorite;
	}

	setFavorite(value)
	{
		this.#favorite = value != 0;
	}

	getCopyable()
	{
		return this.#copyable;
	}

	setCopyable(value)
	{
		this.#copyable = value != 0;
	}

	getNgWord()
	{
		return this.#ngWord;
	}

	setNgWord(value)
	{
		this.#ngWord = value != 0;
	}

	getLocalonly()
	{
		return this.#localonly;
	}

	setLocalonly(value)
	{
		this.#localonly = value != 0;
	}

	getRegionMove()
	{
		return this.#regionMove;
	}

	setRegionMove(value)
	{
		this.#regionMove = value;
	}

	getFontRegion()
	{
		return this.#fontRegion;
	}

	setFontRegion(value)
	{
		this.#fontRegion = value;
	}

	getRoomIndex()
	{
		return this.#roomIndex;
	}

	setRoomIndex(value)
	{
		this.#roomIndex = value;
	}

	getPositionInRoom()
	{
		return this.#positionInRoom;
	}

	setPositionInRoom(value)
	{
		this.#positionInRoom = value;
	}

	getBirthPlatform()
	{
		return this.#birthPlatform;
	}

	setBirthPlatform(value)
	{
		this.#birthPlatform = value;
	}

	getCreateId()
	{
		return this.#createId;
	}

	setCreateId(value, offset = 0)
	{
		this.#createId.set(value.subarray(offset, offset + 10));
	}

	getAuthorType()
	{
		return this.#authorType;
	}

	setAuthorType(value)
	{
		this.#authorType = value;
	}

	getAuthorId()
	{
		return this.#authorId;
	}

	setAuthorId(value, offset = 0)
	{
		this.#authorId.set(value.subarray(offset, offset + 8));
	}

	isValid()
	{
		if (this.#miiVersion <= 0)
			console.log("Invalid: MiiVersion must be > 0");
	}

	dump()
	{
		console.log("Faceline:");
		console.log(`  Type   = ${this.#faceType}`);
		console.log(`  Color  = ${this.#faceColor}`);
		console.log(`  Tex    = ${this.#faceTex}`);
		console.log(`  Make   = ${this.#faceMake}`);
		console.log("");
		console.log("Hair:");
		console.log(`  Type   = ${this.#hairType}`);
		console.log(`  Color  = ${this.#hairColor}`);
		console.log(`  Flip   = ${this.#hairFlip}`);
		console.log("");
		console.log("Eye:");
		console.log(`  Type   = ${this.#eyeType}`);
		console.log(`  Color  = ${this.#eyeColor}`);
		console.log(`  Scale  = ${this.#eyeScale}`);
		console.log(`  Aspect = ${this.#eyeAspect}`);
		console.log(`  Rotate = ${this.#eyeRotate}`);
		console.log(`  X      = ${this.#eyeX}`);
		console.log(`  Y      = ${this.#eyeY}`);
		console.log("");
		console.log("Eyebrow:");
		console.log(`  Type   = ${this.#eyebrowType}`);
		console.log(`  Color  = ${this.#eyebrowColor}`);
		console.log(`  Scale  = ${this.#eyebrowScale}`);
		console.log(`  Aspect = ${this.#eyebrowAspect}`);
		console.log(`  Rotate = ${this.#eyebrowRotate}`);
		console.log(`  X      = ${this.#eyebrowX}`);
		console.log(`  Y      = ${this.#eyebrowY}`);
		console.log("");
		console.log("Nose:");
		console.log(`  Type  = ${this.#noseType}`);
		console.log(`  Scale = ${this.#noseScale}`);
		console.log(`  Y     = ${this.#noseY}`);
		console.log("");
		console.log("Mouth:");
		console.log(`  Type   = ${this.#mouthType}`);
		console.log(`  Color  = ${this.#mouthColor}`);
		console.log(`  Scale  = ${this.#mouthScale}`);
		console.log(`  Aspect = ${this.#mouthAspect}`);
		console.log(`  Y      = ${this.#mouthY}`);
		console.log("");
		console.log("Beard:");
		console.log(`  Mustache = ${this.#mustacheType}`);
		console.log(`  Type     = ${this.#beardType}`);
		console.log(`  Color    = ${this.#beardColor}`);
		console.log(`  Scale    = ${this.#beardScale}`);
		console.log(`  Y        = ${this.#beardY}`);
		console.log("");
		console.log("Glasses:");
		console.log(`  Type  = ${this.#glassType}`);
		console.log(`  Color = ${this.#glassColor}`);
		console.log(`  Scale = ${this.#glassScale}`);
		console.log(`  Y     = ${this.#glassY}`);
		console.log("");
		console.log("Mole:");
		console.log(`  Type  = ${this.#moleType}`);
		console.log(`  Scale = ${this.#moleScale}`);
		console.log(`  X     = ${this.#moleX}`);
		console.log(`  Y     = ${this.#moleY}`);
		console.log("");
		console.log("Body:");
		console.log(`  Height = ${this.#height}`);
		console.log(`  Build  = ${this.#build}`);
		console.log("");
		console.log(`Gender         = ${this.#gender}`);
		console.log(`Birthday       = ${this.#birthMonth}/${this.#birthDay}`);
		console.log(`FavoriteColor  = ${this.#favoriteColor}`);
		console.log(`Favorite       = ${this.#favorite ? "true" : "false"}`);
		console.log(`Copyable       = ${this.#copyable ? "true" : "false"}`);
		console.log(`NG Word        = ${this.#ngWord ? "true" : "false"}`);
		console.log(`Local Only     = ${this.#localonly ? "true" : "false"}`);
		console.log("");
		console.log(`Region Move    = ${this.#regionMove}`);
		console.log(`Font Region    = ${this.#fontRegion}`);
		console.log(`Room Index     = ${this.#roomIndex}`);
		console.log(`Room Position  = ${this.#positionInRoom}`);
		console.log(`Birth Platform = ${this.#birthPlatform}`);
		console.log("");
		console.log("Create ID:");
		let createIdHex = "";
		for (let i = 0; i < 10; i++)
			createIdHex += `${this.#createId[i].toString(16).toUpperCase().padStart(2, "0")} `;
		console.log(createIdHex);
		console.log(`Author Type    = ${this.#authorType}`);
		console.log("Author ID:");
		let authorIdHex = "";
		for (let i = 0; i < 8; i++)
			authorIdHex += `${this.#authorId[i].toString(16).toUpperCase().padStart(2, "0")} `;
		console.log(authorIdHex);
		console.log("Name (UTF-16):");
		let nameText = "";
		for (let i = 0; i < 11; i++)
			nameText += `${this.#name[i].toString(16).toUpperCase().padStart(4, "0")} `;
		console.log(nameText);
		console.log("Creator Name (UTF-16):");
		let creatorText = "";
		for (let i = 0; i < 11; i++)
			creatorText += `${this.#creatorName[i].toString(16).toUpperCase().padStart(4, "0")} `;
		console.log(creatorText);
	}
}

/**
 * Taken From https://github.com/ariankordi/mii-fusion-experiments
 */
export class Ver3StoreData
{

	static LENGTH = 96;

	static toStoreDataBytes(output, info)
	{
		for (let i = 0; i < 96; i++)
			output[i] = 0;
		let tmpU16;
		output[0] = (output[0] & ~255) | (info.getMiiVersion() & 255) << 0;
		output[1] = (output[1] & ~1) | (info.getCopyable() ? 1 : 0) << 0;
		output[1] = (output[1] & ~2) | (info.getNgWord() ? 1 : 0) << 1;
		output[1] = (output[1] & ~12) | (info.getRegionMove() & 3) << 2;
		output[1] = (output[1] & ~48) | (info.getFontRegion() & 3) << 4;
		output[2] = (output[2] & ~15) | (info.getRoomIndex() & 15) << 0;
		output[2] = (output[2] & ~240) | (info.getPositionInRoom() & 15) << 4;
		output[3] = (output[3] & ~15) | (info.getAuthorType() & 15) << 0;
		output[3] = (output[3] & ~112) | (info.getBirthPlatform() & 7) << 4;
		output.set(info.getAuthorId().subarray(0, 8), 4);
		output.set(info.getCreateId().subarray(0, 10), 12);
		output[24] = (output[24] & ~1) | (info.getGender() & 1) << 0;
		output[24] = (output[24] & ~30) | (info.getBirthMonth() & 15) << 1;
		tmpU16 = output[24] | output[25] << 8;
		tmpU16 = (tmpU16 & ~992) | (info.getBirthDay() & 31) << 5;
		output[24] = tmpU16 & 255;
		output[25] = tmpU16 >> 8 & 255;
		output[25] = (output[25] & ~60) | (info.getFavoriteColor() & 15) << 2;
		output[25] = (output[25] & ~64) | (info.getFavorite() ? 1 : 0) << 6;
		let name = info.getName();
		for (let i = 0; i < 10; i++) {
			output[26 + i * 2] = name[i];
			output[26 + i * 2 + 1] = name[i] >> 8;
		}
		output[46] = info.getHeight();
		output[47] = info.getBuild();
		output[48] = (output[48] & ~1) | (info.getLocalonly() ? 1 : 0) << 0;
		output[48] = (output[48] & ~30) | (info.getFaceType() & 15) << 1;
		output[48] = (output[48] & ~224) | (info.getFaceColor() & 7) << 5;
		output[49] = (output[49] & ~15) | (info.getFaceTex() & 15) << 0;
		output[49] = (output[49] & ~240) | (info.getFaceMake() & 15) << 4;
		output[50] = (output[50] & ~255) | (info.getHairType() & 255) << 0;
		output[51] = (output[51] & ~7) | (info.getHairColor() & 7) << 0;
		output[51] = (output[51] & ~8) | (info.getHairFlip() & 1) << 3;
		output[52] = (output[52] & ~63) | (info.getEyeType() & 63) << 0;
		tmpU16 = output[52] | output[53] << 8;
		tmpU16 = (tmpU16 & ~448) | (info.getEyeColor() & 7) << 6;
		output[52] = tmpU16;
		output[53] = tmpU16 >> 8;
		output[53] = (output[53] & ~30) | (info.getEyeScale() & 15) << 1;
		output[53] = (output[53] & ~224) | (info.getEyeAspect() & 7) << 5;
		output[54] = (output[54] & ~31) | (info.getEyeRotate() & 31) << 0;
		tmpU16 = output[54] | output[55] << 8;
		tmpU16 = (tmpU16 & ~480) | (info.getEyeX() & 15) << 5;
		output[54] = tmpU16;
		output[55] = tmpU16 >> 8;
		output[55] = (output[55] & ~62) | (info.getEyeY() & 31) << 1;
		output[56] = (output[56] & ~31) | (info.getEyebrowType() & 31) << 0;
		output[56] = (output[56] & ~224) | (info.getEyebrowColor() & 7) << 5;
		output[57] = (output[57] & ~15) | (info.getEyebrowScale() & 15) << 0;
		output[57] = (output[57] & ~112) | (info.getEyebrowAspect() & 7) << 4;
		output[58] = (output[58] & ~31) | (info.getEyebrowRotate() & 31) << 0;
		tmpU16 = output[58] | output[59] << 8;
		tmpU16 = (tmpU16 & ~480) | (info.getEyebrowX() & 15) << 5;
		output[58] = tmpU16 & 255;
		output[59] = tmpU16 >> 8 & 255;
		output[59] = (output[59] & ~62) | (info.getEyebrowY() & 31) << 1;
		output[60] = (output[60] & ~31) | (info.getNoseType() & 31) << 0;
		tmpU16 = output[60] | output[61] << 8;
		tmpU16 = (tmpU16 & ~480) | (info.getNoseScale() & 15) << 5;
		output[60] = tmpU16 & 255;
		output[61] = tmpU16 >> 8 & 255;
		output[61] = (output[61] & ~62) | (info.getNoseY() & 31) << 1;
		output[62] = (output[62] & ~63) | (info.getMouthType() & 63) << 0;
		tmpU16 = output[62] | output[63] << 8;
		tmpU16 = (tmpU16 & ~448) | (info.getMouthColor() & 7) << 6;
		output[62] = tmpU16 & 255;
		output[63] = tmpU16 >> 8 & 255;
		output[63] = (output[63] & ~30) | (info.getMouthScale() & 15) << 1;
		output[63] = (output[63] & ~224) | (info.getMouthAspect() & 7) << 5;
		output[64] = (output[64] & ~31) | (info.getMouthY() & 31) << 0;
		output[64] = (output[64] & ~224) | (info.getMustacheType() & 7) << 5;
		output[66] = (output[66] & ~7) | (info.getBeardType() & 7) << 0;
		output[66] = (output[66] & ~56) | (info.getBeardColor() & 7) << 3;
		tmpU16 = output[66] | output[67] << 8;
		tmpU16 = (tmpU16 & ~960) | (info.getBeardScale() & 15) << 6;
		output[66] = tmpU16 & 255;
		output[67] = tmpU16 >> 8 & 255;
		output[67] = (output[67] & ~124) | (info.getBeardY() & 31) << 2;
		output[68] = (output[68] & ~15) | (info.getGlassType() & 15) << 0;
		output[68] = (output[68] & ~112) | (info.getGlassColor() & 7) << 4;
		tmpU16 = output[68] | output[69] << 8;
		tmpU16 = (tmpU16 & ~1920) | (info.getGlassScale() & 15) << 7;
		output[68] = tmpU16 & 255;
		output[69] = tmpU16 >> 8 & 255;
		output[69] = (output[69] & ~248) | (info.getGlassY() & 31) << 3;
		output[70] = (output[70] & ~1) | (info.getMoleType() & 1) << 0;
		output[70] = (output[70] & ~30) | (info.getMoleScale() & 15) << 1;
		tmpU16 = output[70] | output[71] << 8;
		tmpU16 = (tmpU16 & ~992) | (info.getMoleX() & 31) << 5;
		output[70] = tmpU16 & 255;
		output[71] = tmpU16 >> 8 & 255;
		output[71] = (output[71] & ~124) | (info.getMoleY() & 31) << 2;
		let creatorName = info.getCreatorName();
		for (let i = 0; i < 10; i++) {
			output[72 + i * 2] = creatorName[i] & 255;
			output[72 + i * 2 + 1] = creatorName[i] >> 8 & 255;
		}
		let crc = Crc16Ccitt.calculate(output, 94, 0);
		output[94] = crc >> 8;
		output[95] = crc & 255;
	}

	static setFromBytes(src, info)
	{
		info.setMiiVersion(src[0]);
		info.setCopyable(src[1] & 1);
		info.setNgWord(src[1] >> 1 & 1);
		info.setRegionMove(src[1] >> 2 & 3);
		info.setFontRegion(src[1] >> 4 & 3);
		info.setRoomIndex(src[2] & 15);
		info.setPositionInRoom(src[2] >> 4);
		info.setAuthorType(src[3] & 15);
		info.setBirthPlatform(src[3] >> 4 & 7);
		info.setAuthorId(src, 4);
		info.setCreateId(src, 12);
		info.setGender(src[24] & 1);
		info.setBirthMonth(src[24] >> 1 & 15);
		info.setBirthDay((src[25] & 3) << 3 | src[24] >> 5);
		info.setFavoriteColor(src[25] >> 2 & 15);
		info.setFavorite(src[25] >> 6 & 1);
		const name = new Uint16Array(10);
		for (let i = 0; i < 10; i++)
			name[i] = src[26 + i * 2] | 0;
		info.setName(name);
		info.setHeight(src[46]);
		info.setBuild(src[47]);
		info.setLocalonly(src[48] & 1);
		info.setFaceType(src[48] >> 1 & 15);
		info.setFaceColor(src[48] >> 5);
		info.setFaceTex(src[49] & 15);
		info.setFaceMake(src[49] >> 4);
		info.setHairType(src[50]);
		info.setHairColor(src[51] & 7);
		info.setHairFlip(src[51] >> 3 & 1);
		info.setEyeType(src[52] & 63);
		info.setEyeColor((src[53] & 1) << 2 | src[52] >> 6);
		info.setEyeScale(src[53] >> 1 & 15);
		info.setEyeAspect(src[53] >> 5);
		info.setEyeRotate(src[54] & 31);
		info.setEyeX((src[55] & 1) << 3 | src[54] >> 5);
		info.setEyeY(src[55] >> 1 & 31);
		info.setEyebrowType(src[56] & 31);
		info.setEyebrowColor(src[56] >> 5);
		info.setEyebrowScale(src[57] & 15);
		info.setEyebrowAspect(src[57] >> 4 & 7);
		info.setEyebrowRotate(src[58] & 31);
		info.setEyebrowX((src[59] & 1) << 3 | src[58] >> 5);
		info.setEyebrowY(src[59] >> 1 & 31);
		info.setNoseType(src[60] & 31);
		info.setNoseScale((src[61] & 1) << 3 | src[60] >> 5);
		info.setNoseY(src[61] >> 1 & 31);
		info.setMouthType(src[62] & 63);
		info.setMouthColor((src[63] & 1) << 2 | src[62] >> 6);
		info.setMouthScale(src[63] >> 1 & 15);
		info.setMouthAspect(src[63] >> 5);
		info.setMouthY(src[64] & 31);
		info.setMustacheType(src[64] >> 5);
		info.setBeardType(src[66] & 7);
		info.setBeardColor(src[66] >> 3 & 7);
		info.setBeardScale((src[67] & 3) << 2 | src[66] >> 6);
		info.setBeardY(src[67] >> 2 & 31);
		info.setGlassType(src[68] & 15);
		info.setGlassColor(src[68] >> 4 & 7);
		info.setGlassScale((src[69] & 7) * 2 | src[68] >> 7);
		info.setGlassY(src[69] >> 3);
		info.setMoleType(src[70] & 1);
		info.setMoleScale(src[70] >> 1 & 15);
		info.setMoleX((src[71] & 3) << 3 | src[70] >> 5);
		info.setMoleY(src[71] >> 2 & 31);
		const creatorName = new Uint16Array(10);
		for (let i = 0; i < 10; i++)
			creatorName[i] = src[72 + i * 2] | 0;
		info.setCreatorName(creatorName);
	}
}

/**
 * Taken From https://github.com/ariankordi/mii-fusion-experiments
 * Implements the CRC-16/CCITT checksum calculation.
 * This class provides a static method for computing the CRC-16/CCITT checksum over an input byte array.
 * The algorithm uses the polynomial 0x1021, an initial value of 0xFFFF, and a default context of 0x0000.
 * The method processes a given number of bytes from the input and can be seeded with a custom context.
 */
export class Crc16Ccitt
{

	/**
	 * Calculates the CRC-16/CCITT checksum for the specified input data.
	 * @param input The byte array containing the data over which to compute the checksum.
	 * @param length The number of bytes from the input array to process.
	 * @param context The initial CRC context value to start with; defaults to Context.
	 */
	static calculate(input, length, context = 0)
	{
		return Crc16Ccitt.calculateFast(input, length, context);
	}

	/**
	 * Calculates the CRC-16/CCITT checksum for the specified input data.
	 */
	static calculateShift(input, length, context = 0)
	{
		let crc = context;
		for (let i = 0; i < length; i++) {
			crc ^= input[i] << 8;
			for (let bit = 0; bit < 8; bit++) {
				if ((crc & 32768) != 0) {
					crc = (crc << 1 ^ 4129) & 65535;
				}
				else {
					crc = crc << 1 & 65535;
				}
			}
		}
		return crc;
	}

	/**
	 * Calculates the CRC-16/CCITT checksum for the specified input data.
	 * Courtesy of Luciano Barcaro: https://stackoverflow.com/a/30357446
	 */
	static calculateFast(input, length, context = 0)
	{
		let crc = context;
		let msb = crc >> 8;
		let lsb = crc & 255;
		for (let i = 0; i < length; i++) {
			let x = input[i] ^ msb;
			x ^= x >> 4;
			msb = (lsb ^ x >> 3 ^ x << 4) & 255;
			lsb = (x ^ x << 5) & 255;
		}
		return msb << 8 | lsb;
	}
}

export class Utf16ToUtf8Converter
{

	/**
	 * Converts a UTF-16 array, not necessarily null-terminated, to a UTF-8 encoded string.
	 * @param utf16 An array of UTF-16 code units.
	 * @param length How many code units to process (length of original string).
	 */
	static convert(utf16, length)
	{
		let buffer = new Uint8Array(length * 4);
		let index = 0;
		let i = 0;
		while (i < length) {
			let c = utf16[i++];
			if (i < length && c >= 55296 && c <= 56319) {
				let next = utf16[i];
				if (next >= 56320 && next <= 57343) {
					c = 65536 + ((c & 1023) << 10) + (next & 1023);
					i++;
				}
			}
			if (c >= 55296 && c <= 57343)
				c = 65533;
			if (c < 128) {
				buffer[index++] = c;
			}
			else if (c < 2048) {
				buffer[index++] = 192 | c >> 6;
				buffer[index++] = 128 | (c & 63);
			}
			else if (c < 65536) {
				buffer[index++] = 224 | c >> 12;
				buffer[index++] = 128 | (c >> 6 & 63);
				buffer[index++] = 128 | (c & 63);
			}
			else {
				buffer[index++] = 240 | c >> 18;
				buffer[index++] = 128 | (c >> 12 & 63);
				buffer[index++] = 128 | (c >> 6 & 63);
				buffer[index++] = 128 | (c & 63);
			}
		}
		return new TextDecoder().decode(buffer.subarray(0, index));
	}
}
